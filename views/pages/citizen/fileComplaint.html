<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet" />
    <title>File Complaint</title>
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/toast.css" />
    <link rel="stylesheet" href="../../css/components/sidebar.css" />
    <link rel="stylesheet" href="../../css/complaint-form.css" />
    <link rel="stylesheet" href="../../css/app.css" />
    <link rel="stylesheet" href="../../css/header-redesign.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div class="app-container">
      <div class="header-container"></div>
      <div id="sidebar" class="collapsible"></div>
      <div id="app" class="collapsible">
        <div class="complaint-form-container">
          <h1>File Complaint</h1>
          <form id="complaintForm" class="complaint-form">
            <div class="form-group">
              <label for="complaintTitle">Complaint Title *</label>
              <input
                type="text"
                id="complaintTitle"
                name="complaintTitle"
                required
                placeholder="Enter a descriptive title for your complaint"
              />
            </div>
            <div class="form-group">
              <label for="complaintCategory">Complaint Category *</label>
              <select id="complaintCategory" name="complaintCategory" required>
                <option value="">Select a category</option>
                <div class="loading-placeholder">Loading categories...</div>
              </select>
            </div>
            <div class="form-group">
              <label for="complaintSubcategory">Complaint Subcategory *</label>
              <select id="complaintSubcategory" name="complaintSubcategory" required disabled>
                <option value="">Select a subcategory</option>
              </select>
            </div>
            <div class="form-group">
              <label>Relevant Departments</label>
              <div class="department-selection-info">
                <p class="info-text">Departments will be automatically selected based on your subcategory choice. You can modify the selection if needed.</p>
              </div>
              <div id="departmentCheckboxes" class="checkbox-group">
                <div class="loading-placeholder">Select a subcategory to see relevant departments</div>
              </div>
            </div>
            <div class="form-group">
              <label for="description">Description *</label>
              <textarea
                id="description"
                name="description"
                required
                placeholder="Please provide a detailed description of your complaint..."
                rows="5"
              ></textarea>
            </div>
            <div class="form-group">
              <label for="location">Location *</label>
              <input
                type="text"
                id="location"
                name="location"
                required
                placeholder="Enter the specific location of the complaint"
              />
            </div>
            <div class="form-group">
              <label>Pin Location on Map</label>
              <div id="complaint-map" style="width: 100%; height: 320px; border: 1px solid #ddd; border-radius: 6px; position: relative;"></div>
              <input type="hidden" id="latitude" name="latitude" />
              <input type="hidden" id="longitude" name="longitude" />
            </div>
            <div class="form-group">
              <label for="evidence">Evidence (Optional)</label>
              <div class="file-upload-container">
                <div class="file-drop-zone" id="fileDropZone">
                  <div class="drop-zone-content">
                    <div class="upload-icon">üìÅ</div>
                    <p>Drag and drop files here or click to browse</p>
                    <p class="file-types">
                      Supported: Images, Audio, Video (Max 5 files)
                    </p>
                    <input
                      type="file"
                      id="evidenceFiles"
                      name="evidenceFiles"
                      multiple
                      accept="image/*,audio/*,video/*"
                      style="display: none"
                    />
                  </div>
                </div>
                <div class="file-preview" id="filePreview"></div>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="submit-btn">Submit Complaint</button>
              <button
                type="button"
                class="cancel-btn"
                onclick="window.history.back()"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div id="toast-container" class="toast-container"></div>
    <!-- Core Scripts -->
    <script type="module" src="../../js/components/toast.js"></script>
    <script type="module" src="../../js/components/header.js"></script>
    <script type="module" src="../../js/components/sidebar.js"></script>
    <script type="module" src="../../js/auth/authChecker.js"></script>
    
    <!-- Citizen-Only Access Check -->
    <script type="module" src="../../js/pages/citizen-file-complaint-access.js"></script>
    
    <!-- Map Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="../../js/components/map/complaintLocationPicker.js"></script>
    
    <!-- Complaint Form Scripts (loaded last) -->
    <script type="module" src="../../js/components/form/complaintFormHierarchical.js"></script>
</body>
</html>
