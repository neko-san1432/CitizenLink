<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Server Logs - Super Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/toast.css">
  <link rel="stylesheet" href="/css/components/clock.css">
  <link rel="stylesheet" href="/css/components/sidebar.css">
  <link rel="stylesheet" href="/css/app.css">
  <link rel="stylesheet" href="/css/header-redesign.css">
  <link rel="stylesheet" href="/css/pages/super-admin-logs.css">
  <link rel="stylesheet" href="/css/viewport-fix.css">
</head>
<body>
  <div id="dashboard-clock" class="dashboard-clock" aria-live="polite"></div>
  <div class="app-container">
    <div class="header-container"></div>
    <div id="sidebar" class="collapsible"></div>

    <div id="app" class="collapsible superadmin-dashboard">
      <div class="dashboard-header-section">
        <div class="dashboard-title-group">
          <h1>Server Logs</h1>
          <p class="dashboard-subtitle">View system logs including role changes, office transfers, and complaint workflow</p>
        </div>
      </div>

      <!-- Main Command Center Grid -->
      <div class="dashboard-grid-logs">
        
        <!-- Left Column: Activity Feed Sidebar -->
        <aside class="log-sidebar">
          <div class="log-panel" style="height: 100%;">
            <div class="panel-header">
              <div class="panel-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                </svg> Activity Feed
              </div>
              <div class="panel-controls">
                 <button class="icon-btn" title="Filter Settings" onclick="toggleFeedFilters()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 6.707A1 1 0 013 6.586V4z" />
                    </svg>
                 </button>
                 <button class="icon-btn" title="Refresh" onclick="loadLogs()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                 </button>
              </div>
            </div>
            <!-- Hidden Filter Menu -->
            <div id="feed-filters" class="feed-filters hidden" style="padding: 1rem; background: var(--gray-50); border-bottom: 1px solid var(--gray-200);">
               <select id="log-type-filter" class="filter-select" style="width: 100%;">
                 <option value="all">All Events</option>
                 <option value="role_changes">Role Changes</option>
                 <option value="security">Security Alerts</option>
                 <option value="errors">System Errors</option>
               </select>
            </div>

            <div id="logs-container" class="feed-container">
               <!-- Logs injected here via JS -->
               <div class="loading">
                 <div class="spinner"></div>
                 <p>Syncing feed...</p>
               </div>
            </div>
          </div>
        </aside>

        <!-- Right Column: Main Content (KPIs + Terminal) -->
        <main class="log-main">
          
          <!-- 1. KPI Status Row -->
          <div class="stats-row">
            <div class="stat-card">
                <div class="stat-icon-wrapper healthy" id="status-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <div class="stat-label">System Health</div>
                  <div class="stat-value" id="system-status-text">Healthy</div>
                  <div class="stat-subtext">All services operational</div>
                </div>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon-wrapper warning">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
              </div>
              <div class="stat-content">
                <div class="stat-label">Recent Errors</div>
                <div class="stat-value" id="error-count">0</div>
                <div class="stat-subtext">In the last hour</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
              </div>
              <div class="stat-content">
                <div class="stat-label">Active Users</div>
                <div class="stat-value" id="active-users-count">-</div>
                <div class="stat-subtext">Currently online</div>
              </div>
            </div>
          </div>

          <!-- 2. Terminal Matrix -->
          <div class="log-panel terminal-panel" style="flex: 1; display: flex; flex-direction: column;">
            <div class="panel-header">
              <div class="window-controls">
                <div class="win-dot red"></div>
                <div class="win-dot yellow"></div>
                <div class="win-dot green"></div>
              </div>
              <span class="terminal-title-text">root@citizenlink-server:~/logs# tail -f system.log</span>
              
              <div class="terminal-toolbar">
                <button id="term-pause-btn" class="term-btn" onclick="toggleTerminalPause()">
                   Pause
                </button>
                 <button class="term-btn" onclick="clearTerminal()">
                   Clear
                </button>
              </div>
            </div>
            
            <div id="terminal-logs-container" class="matrix-view">
               <div style="color: #6b7280; padding: 1rem;">Initializing secure connection to log stream...</div>
            </div>
          </div>

        </main>
      </div>
      
      <!-- Drill Down Side Panel -->
      <div id="log-insight-panel" class="log-insight-panel">
         <div class="insight-header">
            <div class="insight-title">Log Details</div>
            <button class="insight-close" onclick="closeInsightPanel()">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" style="width:20px;height:20px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
         </div>
         <div id="insight-content" class="insight-body">
            <!-- Details injected here -->
         </div>
      </div>
    </div>
      </div>
    </div>
  </div>

  <div id="toast-container" class="toast-container"></div>
  <script type="module" src="../../js/components/toast.js"></script>
  <script type="module" src="../../js/components/header.js"></script>
  <script type="module" src="../../js/components/sidebar.js"></script>
  <script type="module" src="../../js/auth/authChecker.js"></script>
  <script type="module" src="../../js/auth/roleToggle.js"></script>
  <script type="module" src="../../js/components/clock.js"></script>
  <script type="module" src="../../js/super-admin/server-logs.js"></script>
</body>
</html>

